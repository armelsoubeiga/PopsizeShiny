{
    "contents" : "---\ntitle: \"TP3_Sondage_Armel\"\nauthor: \"Armel SOUBEIGA\"\ndate: \"Saturday, December 09, 2017\"\noutput: pdf_document\n---\n\n# 1. Une r?union de planification a lieu afin de d?terminer la taille de l'?chantillon ? prendre pour un sondage al?atoire simple (sans remise). Plusieurs services de la Stephens County Cablevision Inc. y participent. La variable principale est le montant que les ?ventuels abonn?s seraient prets ? payer pour le service. Une enquete pr?liminaire nous indique que la moyenne serait de l'ordre de 10,5$ tandis la variance (corrig?e) serait de l'ordre de 6,8$\n\n##(a) Dans le compte rendu de cette r?union on donne les exigences des diff?rentes services. Les services comptables demandaient un ?cart type de 0,5$ pour la moyenne ?chantillonnale. Le service ? la client?le que le coefficient de variation de l'estimation de la moyenne soit de 0,05. De son cot? le service de la pr?vision des couts d'enqu?te exige une marge d'erreur absolue de 0,9$. Finalement, le service du renouvellement des abonnements pr?f?rait une marge d'erreur ralative de 10%. Donner les tailles n?cessaires pour satisfaire les exigences de chacun.\n\n```{r}\n#On consid?rera la variance donn?e comme l'?cart-type corrig? par recherche de coh?rence des r?sultats.\nsigma<-6.8\n#Le coefficient de variation de l'estimation de la moyenne soit de 0.05\ncoef_donne<-0.05\n#Erreur absolue exige est 0.9\nerreur_ab<-0.9\n#Erreur relative exige est 10%=0.1\nerreur_rl<-0.1\n#N est ?gal ? 19664 parce que le nombre de m?nages dans ville de Lockhart est 19664\nN<-19664\nmu<-10.5\n```\n\n\n##1er cas: Les services comptables demandaient un ?cart type de 0,5 pour la moyenne ?chantillonnale.\n\nOn cherche ? avoir un ?cart type de 0,5.(c'est-?-dire,$\\sigma_{\\bar{y}}$) . Avec la taille de l'?chantillon N=19664. Donc N est assez grand, et nous estimerons donc S par $s=6.8$, la valeur de n pour laquelle $\\sigma_{\\bar{y}}=D$ est appromimativement \n\n\\[no=\\frac{S^2}{D^2}\\]\n\nFaisons l'ajustement: \n\n\\[n=\\frac{n_{o}}{1+\\frac{n_{o}}{N}}\\]\n\n\n```{r}\nn0<-((sigma^2)/(0.5)^2)\nn0\nn_compt<-n0/(1+(n0/N))\nround(n_compt)\n```\nLa taille pour satisfaire l'exigence de l'?cart type de 0.5 par les services comptables est n=183.\n\n\n\n##2ieme cas: Le service ? la client?le que le coefficient de variation de l'estimation de la moyenne soit de 0.05\n\nLe coefficient de variation d'une variable Y est\n\n\\[C_{y}=\\frac{S_{y}}{\\mu_{y}}\\]\n\nOn estime S par s=6.8 et $\\mu$ par $\\bar{y}$=10.5\n\n```{r}\n#Le coefficient de variation\ncoeff_variaton<-sigma/mu\ncoeff_variaton\n```\n\nOn exige une estimation ayant un coefficient de variation donn? C, c'est-?-dire, on cherche la valeur de n pour laquelle\n\n\\[\\frac{\\sigma_{\\bar{y}}}{\\mu}=C\\]\n\nIci C = 0.05\n\nL'approximation de la taille de l'?chantillon est donn? par:\n\n\\[n_{o}=(\\frac{S}{\\mu*C})^2=(\\frac{\\frac{S}{\\mu}}{C})^2=(\\frac{C_{y}}{C})^2\\]\n\nL'ajustement donne:\n\n\\[n=\\frac{n_{o}}{1+\\frac{n_{o}}{N}}\\]\n\n```{r}\n#L'approximation de la taille de l'?chantillon \n(coeff_variaton/coef_donne)^2->n0\nn_client<-n0/(1+(n0/N))\nround(n_client)\n```\n\nLa taille pour satisfaire l'exigence du coefficient de variation donn? de 0.05 par le service ? la client?le est n=166.\n\n##3me cas: Le cot? de service de la pr?vision des co?ts d'enqu?te exige une marge d'erreur absolue de 0.9.\n\nLa demi-largeur $\\ C_{\\frac{\\alpha}{2}}*\\sigma_{\\bar{y}}$ d'un intervalle de confiance $\\bar{y}+ C_{\\frac{\\alpha}{2}}$ ou $\\bar{y} - C_{\\frac{\\alpha}{2}}$ est une indication de l'erreur qu'on risque de commettre lorsqu'on estime $\\mu$ par $\\bar{y}$. Ceci est la __marge d'erreur__ ? 100(1-$\\alpha$)%.\nUne facon naturelle d'exprimer la pr?cision d'un ?chantillonage est de fixer un nombre E et d'exiger que la marge d'erreur ? 100(1-$\\alpha$)% soit ?gale ? E. On trouve $\\sigma_{\\bar{y}}=\\frac{E}{c_{\\frac{\\alpha}{2}}}$. On peut donc obtenir une approximation de la taille.\n\n\\[n0=(\\frac{C_{\\frac{\\alpha}{2}}*S}{E})^2\\]\n\nIci supposons qu'on veuille estimer la moyenne avec une marge d'erreur de 0.9 ? un niveau de confiance de 95%. On estime S par $s=2.607681$ et puisque ? 95% $\\ c_{\\frac{\\alpha}{2}}$=1.96 On a\n\n```{r}\nn0<-(((1.96*6.8)/0.9)^2)\nn_prevision<-n0/(1+(n0/N))\nround(n_prevision)\n```\n\nLa taille pour satisfaire l'exigence de la marge d'erreur absolue de 0.9 par le service de la pr?vision est n=217.\n\n## 4?me cas: Le service du renouvellement des abonnements pr?f?rerait une marge d'erreur relative de 10%\n\nIl arrive souvent qu'on veuille imposer une limite R ? la marge d'erreur relative soit $\\ c_{\\frac{\\alpha}{2}}*\\sigma_{\\bar{y}}{\\mu}$ et qu'on exige alors que \n\n\\[\\frac{\\ c_{\\frac{\\alpha}{2}}*\\sigma_{\\bar{y}}{\\mu}}{\\mu}=R\\]\n\nCette exigence est ?quivalente ?\n\n\n\\[\\sigma_{\\bar{y}}=\\frac{\\mu*R}{ c_{\\frac{\\alpha}{2}}}\\]\n\net il vient donc\n\n\\[n0=(\\frac{c_{\\frac{\\alpha}{2}}*S}{\\mu *S})^2 =(\\frac{c_{\\frac{\\alpha}{2}}*C_{y}}R)^2\\]\n\n\n```{r}\nn0<-(((1.881*coeff_variaton))/0.1)^2\nn_abonnement<-n0/(1+(n0/N))\nround(n_abonnement)\n```\n\nLa taille de l'?chantillon pour satisfaire l'exigence de la marge d'erreur relative de 10% par le service du renouvellement des abonnements est n=147.\n\n\n##(b) A la fin de la r?union, des discussions ont eu lieu afin de trouver une taille ?chantillonnale acceptable pour tous, y compris les services financiers qui eux n'ont pas donn? d'avis relativement ? la pr?cision esp?r?e de l'estimateur de la moyenne du montant que les ?ventuels abonn?s seraient prets ? payer pour le service. On d?cide de prendre un ?chantillon de taille n=200. Que pensez-vous de cette d?cision?\n\nIl n'y a que les exigences du service de pr?vision qui ne seront pas remplies pour n=200. En fait, pour avoir une marge d'erreur absolue de 0.9 euros il faudrait au moins 217 ?chantillons\n\n\n\n#2/Utilisez le programme ADDGEN pour g?n?rer 200 adresse al?atoires dans ville de Lockhart puis le programme SURVEY pour obtenir les r?ponses de ces foyers. Estimez et assurez vous de donner les erreurs types pour toutes les estimations (Utiliser le facteur de correction pour population fini meme si cela peut ne pas etre strictement necessaire)\n\nLe facteur de correction est donn? par $\\sqrt(1-\\frac{n}{N})$\n\n\n##a) Le prix moyen qu'un m?nage est pret ? payer pour la t?l?vision par cable\n\nL'erreur type est donn?e par la formule suivante: en posant $\\ f=\\frac{n}{N}$\n\n\\[\\sigma_{\\bar{d}} = \\sqrt(1-f) * \\frac{S_{d}}{\\sqrt(n)}\\] \n\n\n```{r}\ntp<-read.table(\"C:\\\\Users\\\\Armel soubeiga\\\\Desktop\\\\Mes COURS\\\\SSD_UGA\\\\M1\\\\Sondage\\\\TP3\\\\rep1724.txt\",sep=\"\",dec=\".\",header=TRUE)\nn<-200\nN<-31989\nf<-n/N\n```\n\n```{r}\n#En regardant la question 4 du questionnaire au sujet du TP3 du prix que \n#le m?nage est pret ? payer pour la cable est 5,10,15,20,25 euros par mois et\n#en v?rifiant les donn?es on voit la 7?me colonne contient les r?ponses ? la question 4\n\n#La moyenne\nmean(tp[,7])->yb7\nyb7\n#L'estimation de cette moyenne \nyb7*sqrt(1-(n/N))->yh7\nyh7\n#L'erreur type\n(sd(tp[,7])/sqrt(n))*sqrt(1-f)\n```\n\nEn moyenne,les m?nages sont pr?ts ? payer environ 9.77 pour le cable avec une erreur-type de 0.46\n\n\n##b)Le nombre moyen de t?l?viseurs d'un m?nage ? ville de Lockhart\n\n```{r}\n#En regardant la question 3 du questionnaire au sujet du TP3\n#du nombre de la t?l?viseur que poss?de le foyer et \n#en v?rifiant les donn?es on voit la 6?me colonne contient les r?ponses ? la question 3\n\n#La moyenne\nmean(tp[,6])->yb6 \nyb6\n#L'estimation de cette moyenne \nyb6*sqrt(1-(n/N))->yh6\nyh6\n#L'erreur type\n(sd(tp[,6])/sqrt(n))*sqrt(1-f)\n```\n\nEn moyenne, chaque m?nage poss?de 1.8 t?l?viseurs. et l'erreur type est environ 0.079\n\n##c)La proportion de foyers dispos?es ? payer au moins 10 $ pour le service de c?blodistribution.\n\n```{r}\np_foyer<-sum(tp[,7]>=10)/n\np_foyer*sqrt(1-(n/N))->p_foyerh\np_foyer\np_foyerh\n#L'erreur type\n(sd(tp[,7]>=10)/sqrt(n))*sqrt(1-f)\n```\n\nEn moyenne, 65% des foyers sont pr?ts ? payer au moins 10$ pour le cable dans la ville de Lockhart et l'erreur type de l'estimation est 0.033\n\n\n#3/A l'aide de votre ?chantillon de taille 200, estimer l'?valuation moyenne des unit?s d'habitaions de ville de Lockhart. Un intervalle de confiance ? 95% comprend-il la valeur connue de 71117$? \n\nPour cette question, il faut cr?er une fonction afin de calculer l'intervalle de confiance de la moyenne. Lorsque la confiance vaut 95% $Z_{1-\\frac{\\alpha}{2}}$ vaut qnorm(1-$\\frac{\\alpha}{2}$)\nL'intervalle de confiance va donc de:\n\n\\[ [Moyenne -Z_{1-\\frac{\\alpha}{2}}*\\frac{\\sigma}{\\sqrt(n)},Moyenne +Z_{1-\\frac{\\alpha}{2}}*\\frac{\\sigma}{\\sqrt(n)}]\\]\n\n\n```{r}\nevaluation<-tp[,3]\nintconf<- function(echant, n, nivconf) {\n  #echant: ?chantillon\n  #n: taille de l'?chantillon\n  #nivconf: niveau de confiance\n  int <- (1 - nivconf)/2\n  binf <- mean(echant) + qnorm(int)*sd(echant)/sqrt(n)\n  bsup <- mean(echant) - qnorm(int)*sd(echant)/sqrt(n)\n  bornes <- c(binf, bsup)\n  return(bornes)\n}\n\nintconf(evaluation,200,0.95)\n```\n\nNotre intervalle comprend bien la valeur 71 117. Avec une marge d'erreur de 5%, la moyenne de la valeur des habitations de la ville de Lockhart se situe entre 67516.82 et 72154.26\n\n\n#4/ Utilisez votre échantillon pour tracer un histogramme des réponses ? la question 8 de l'enquete (nombre d'heures ? regarder des ?missions pour enfants). La r?partition du nombre d'heures passées ? regarder des ?missions pour enfants dans les m?nages de ville de Lockhart apparait normale? Trouver un intervalle de confiance approximatif de 95% pour le nombre moyen d'heures passées ? regarder des émissions pour enfants. A la lumi?re de votre histogramme, est-il raisonnable de calculer un tel intervalle de confiance? Pourquoi ou pourquoi pas? Pensez-vous que la distribution d'échantillonnage du temps moyen d'?coute d'?missions pour enfants puisse être normale ?\n\n\n```{r}\nemission_enfant<-tp[,11]\nhist(emission_enfant,main=\"Nombre d'heures a regarder des émissions pour enfants\")\n```\n\nLa répartition du temps d'?coute d'?missions pour enfants ne semble pas suivre une loi normale : on ne reconnait pas sur l'histogramme la forme typique en cloche.\nCela semble logique, en effet une loi normale correspond à une distribution al?atoire, mais le temps d'écoute d'?missions pour enfants ne peut pas ?tre ind?pendant du nombre de ménages.\n\n```{r}\nshapiro.test(emission_enfant)\nintconf(emission_enfant,200,0.95)\n```\n\n\nL'intervalle de confiance approximatif de 95% pour le nombre moyen d'heures pass?es ? regarder des ?missions pour enfants est [2.5186,4.0614]\n\nL'intervalle se construisant ? partir des fractiles de la loi normale, et la normalit? ?tant rejet?e par le test de shapiro-wilk au seuil de 5%, cet intervalle ne pr?sente peu d'int?r?t.\n\n\n#5/En utilisant le meme ?chantillon de taille 200, répétez l'exercice 2,en utilisant une estimation de ratio avec la valeur ?valu?e de la maison comme variable auxiliaire. Quelle estimation de la moyenne donne une plus grande pr?cision?\n\n\n```{r}\n#Le cas: Le prix moyen qu'un m?nage est pret ? payer pour la t?l?vision par cable\nratio_prix<-sapply(1:200,function(x) tp[x,7]/tp[x,3])\ncbind(tp,ratio_prix)->tp\nx1<-mean(tp$ratio_prix)*71117\nx1\n\n#Le cas: Le nombre moyen de t?l?viseurs d'un m?nage ? ville de Lockhart\nratio_tv<-sapply(1:200,function(x) tp[x,6]/tp[x,3])\ncbind(tp,ratio_tv)->tp\nx2<-mean(tp$ratio_tv)*71117\nx2\n\n#Le cas: La proportion de foyers dispos?es ? payer au moins 10$\n#pour le service de c?blodistribution.\nratio_foyer<-sapply(1:131,function(x) sum(tp[tp[,7]>=10,][x,7])/131)\n\n\n\n\n```\n\n\nEn utilisant la moyenne des ratios, on retrouve environ les valeurs calcul?es pr?c?demment ce qui veut dire qu'utiliser les ratios permet d'affiner notre estimation.\n\n\n#6/ En utilisant votre ?chantillon de taille 200 estimez le nombre moyen d'adultes par m?nage dans les m?nages de la ville de Lockhart prets ? payer au moins 10$ pour le service de cablodistribution . Donner l'erreur-type et le coefficient de variation estim? de votre estimation.\n\n```{r}\n#On ?limine les lignes pour lesquels Q4>=1010 c'est ? dire les individus qui sont prets\n#? payer au moins 10$ pour le service cablodistribution\ntp2<-tp[tp$Q4>=10,]\nnrow(tp2)->n2\n#On consid?re l'adulte pour tous les individus d'?ge sup?rieur ? 12 ans.\nmean(tp2$Q1)->y_bar1 \ny_bar1\nsd(tp2$Q1)->s1\ns1/y_bar1->Cy1\ny_bar1*sqrt(1-(n2/N))->y_hat1\ny_hat1\n#L'erreur type\n(s1/sqrt(n))*sqrt(1-f) \n#Le coefficient de variation\nCy1\n```\n\nIl y'a en moyenne 2.50 adultes par m?nages pr?ts ? payer 10$ ou plus pour le cable avec une avec une erreur type de 0.07  (L'importance de l'?cart qui peut exister entre l'estimation de y_hat1 et la vraie valeur de celui-ci) et un coefficient de variation de 0.400\n\n\n#7/A l'aide de votre ?chantillon de taille 200, estimez le nombre total d'adultes ? ville de Lockhart qui vivent dans les m?nages prets ? payer au moins 10$ pour le service de cablodistribution. Donner l'erreur-type et le coefficient de variation estim? de votre estimation.\n\n\n```{r}\n#Le nombre total d'adultes ? ville de Lockhart\nNy<-p_foyerh*N\nNy\nyb_Ny<-mean((tp[,7]>=10)/n)*Ny\ns_Ny<-sd((tp[,7]>=10)/n)*Ny\nc_Ny<-s_Ny/yb_Ny\nEr_Ny<-(s_Ny/sqrt(n))*sqrt(1-n/Ny)\n#La moyenne estim?\nyb_Ny\n#L'ecart type estim?\ns_Ny\n#Le coefficient de variation estim?\nc_Ny\n#L'erreur-type estim?\nEr_Ny\n```\n",
    "created" : 1512906924095.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "725660691",
    "id" : "35B396C2",
    "lastKnownWriteTime" : 1512907034,
    "path" : "C:/Users/Armel soubeiga/Desktop/Mes COURS/SSD_UGA/M1/Sondage/TP3/TP3_Sondage_Armell.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}